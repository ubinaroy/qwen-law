`low_cpu_mem_usage` was None, now default to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.33s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:02<00:02,  1.18s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:03<00:01,  1.09s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.00s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:04<00:00,  1.07s/it]

Data Mapping...

Map:   0%|          | 0/2 [00:00<?, ? examples/s]Map: 100%|██████████| 2/2 [00:00<00:00, 187.12 examples/s]
[1m[34mswanlab[0m[0m: \ Waiting for the swanlab cloud response.                                                                                                    [1m[34mswanlab[0m[0m: \ Getting project...                                                                                                    [1m[34mswanlab[0m[0m: \ Creating experiment...                                                                                                    /data/workbench/sft_train.py:214: FutureWarning: `tokenizer` is deprecated and removed starting from version 0.16.0 for `SFTTrainer.__init__`. Use `processing_class` instead.
  sft_trainer = SFTTrainer(
[1m[34mswanlab[0m[0m: Tracking run with swanlab version 0.4.12
[1m[34mswanlab[0m[0m: Run data will be saved locally in [35m[1m/data/workbench/swanlog/run-20250312_003420-e0cefe01[0m[0m
[1m[34mswanlab[0m[0m: 👋 Hi [1m[39mroychen37326[0m[0m, welcome to swanlab!
[1m[34mswanlab[0m[0m: Syncing run [33mQwen-sft[0m to the cloud
[1m[34mswanlab[0m[0m: 🌟 Run `[1mswanlab watch /data/workbench/swanlog[0m` to view SwanLab Experiment Dashboard locally
[1m[34mswanlab[0m[0m: 🏠 View project at [34m[4mhttps://swanlab.cn/@roychen37326/Qwen-Law[0m[0m
[1m[34mswanlab[0m[0m: 🚀 View run at [34m[4mhttps://swanlab.cn/@roychen37326/Qwen-Law/runs/7w1d63ctleszx1r1almx2[0m[0m
Converting train dataset to ChatML:   0%|          | 0/2 [00:00<?, ? examples/s]Converting train dataset to ChatML: 100%|██████████| 2/2 [00:00<00:00, 703.86 examples/s]
Applying chat template to train dataset:   0%|          | 0/2 [00:00<?, ? examples/s]Applying chat template to train dataset: 100%|██████████| 2/2 [00:00<00:00, 654.54 examples/s]
Truncating train dataset:   0%|          | 0/2 [00:00<?, ? examples/s]Truncating train dataset: 100%|██████████| 2/2 [00:00<00:00, 635.50 examples/s]
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2025-03-12 00:34:26,948] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/root/miniconda3/envs/qwen_law/lib/python3.10/site-packages/transformers/optimization.py:591: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(

SFT training...

  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:01<00:02,  1.29s/it] 67%|██████▋   | 2/3 [00:04<00:02,  2.41s/it]100%|██████████| 3/3 [00:07<00:00,  2.61s/it]                                             100%|██████████| 3/3 [00:12<00:00,  2.61s/it]100%|██████████| 3/3 [00:12<00:00,  4.07s/it]
{'train_runtime': 12.2399, 'train_samples_per_second': 0.49, 'train_steps_per_second': 0.245, 'train_loss': 2.1469650268554688, 'mean_token_accuracy': 0.5984252095222473, 'epoch': 3.0}
[1m[34mswanlab[0m[0m: 🌟 Run `[1mswanlab watch /data/workbench/swanlog[0m` to view SwanLab Experiment Dashboard locally
[1m[34mswanlab[0m[0m: 🏠 View project at [34m[4mhttps://swanlab.cn/@roychen37326/Qwen-Law[0m[0m
[1m[34mswanlab[0m[0m: 🚀 View run at [34m[4mhttps://swanlab.cn/@roychen37326/Qwen-Law/runs/7w1d63ctleszx1r1almx2[0m[0m
[1m[34mswanlab[0m[0m: \ Waiting for uploading complete[1m[34mswanlab[0m[0m: | Waiting for uploading complete[1m[34mswanlab[0m[0m: / Waiting for uploading complete[1m[34mswanlab[0m[0m: - Waiting for uploading complete[1m[34mswanlab[0m[0m: \ Waiting for uploading complete[1m[34mswanlab[0m[0m: | Waiting for uploading complete[1m[34mswanlab[0m[0m: / Waiting for uploading complete[1m[34mswanlab[0m[0m: - Waiting for uploading complete[1m[34mswanlab[0m[0m: \ Waiting for uploading complete[1m[34mswanlab[0m[0m: | Waiting for uploading complete                                                                                                    [1m[34mswanlab[0m[0m: \ Updating experiment status...                                                                                                    
Finished...

